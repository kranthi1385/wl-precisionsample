<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
    <title>OpinionNetwork Surveys</title>
    <meta name="description" content="Opinionetwork: market research technology, data collection" />
    <meta name="author" content="Opinionetwork" />
    <meta name="copyright" content="copyright 2010 - Federated Sample, LLC" />
    <link rel="stylesheet" href="/css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="/css/960.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="/css/main.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="/css/slide.css" type="text/css" media="screen" />
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css"
        rel="stylesheet" type="text/css" />
    <!-- additional styles for Feedback form modal -->
    <!-- 
	<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/black-tie/jquery-ui.css" type="text/css" />
	<link rel="stylesheet" href="css/main.css?v=3" type="text/css" />
	-->

    <script src="/Scripts/jquery.1.7.1.min.js" type="text/javascript"></script>

    <script type="text/javascript" src="/Scripts/knockout-2.3.0.js"></script>

    <script src="/Scripts/jquery.tmpl.min.js" type="text/javascript"></script>

    <script src="/Scripts/knockout.mapping-latest.debug.js" type="text/javascript"></script>

    <script src="/Scripts/knockout.mapping-latest.js" type="text/javascript"></script>

    <script type="text/javascript" src="https://apis.google.com/js/client:platform.js"></script>

    <script type="text/javascript" src="https://connect.facebook.net/en_US/all.js"></script>

    <script type="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>

    <script src="/Scripts/Pages/s1.js" type="text/javascript"></script>

    <style type="text/css">
        #btnUnsubscribe
        {
            background: rgb(219,200,254);
            background: -moz-linear-gradient(top, rgba(219,200,254,1) 0%, rgba(212,181,253,1) 100%);
            background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(219,200,254,1)), color-stop(100%,rgba(212,181,253,1)));
            background: -webkit-linear-gradient(top, rgba(219,200,254,1) 0%,rgba(212,181,253,1) 100%);
            background: -o-linear-gradient(top, rgba(219,200,254,1) 0%,rgba(212,181,253,1) 100%);
            background: -ms-linear-gradient(top, rgba(219,200,254,1) 0%,rgba(212,181,253,1) 100%);
            background: linear-gradient(to bottom, rgba(219,200,254,1) 0%,rgba(212,181,253,1) 100%);
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#dbc8fe', endColorstr='#d4b5fd',GradientType=0 );
            -moz-border-radius: 3px;
            -webkit-border-radius: 3px;
            border-radius: 3px; /* future proofing */
            -khtml-border-radius: 3px; /* for old konqueror browsers */
            padding: 8px 18px;
            border: 1px solid #999999;
            font-size: 18px;
            font-weight: bold;
            color: #52085E;
            text-decoration: none;
            width: 150px;
            font-family: 'Trebuchet MS' ,Arial,Helvetica,sans-serif;
        }
        .center
        {
            margin: auto;
        }
        .help-inline
        {
            display: inline-block;
            vertical-align: middle; /*padding-left: 5px;*/
            min-width: 22%;
            text-align: left;
            font-family: Consolas, 'Lucida Console' , monospace;
            font-size: medium;
        }
        #dvImgLoading
        {
            background: url(/Images/loading_big.gif) no-repeat center center;
            height: 90px;
            width: 90px;
            position: fixed;
            z-index: 1000;
            left: 50%;
            top: 27%;
            padding-top: 10px;
            vertical-align: middle;
            font-size: 12px;
            align: center;
        }
    </style>

    <script language="javascript" type="text/javascript">
        FB.init({
            appId: '411622555678304',

            status: true, // check login status
            cookie: true, // enable cookies to allow the server to access the session
            xfbml: true, // parse XFBML
            version: 'v2.2'
        });                            
    </script>

    <script language="javascript" type="text/javascript">
        var fb = '';
        function fb_login() {
            FB.getLoginStatus(function(response) {
                statusChangeCallback(response);
            });
        }
        function getUrlVars() {
            var Url = window.location.href.toLowerCase();
            var vars = {};
            var parts = Url.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m, key, value) {
                vars[key] = value;
            });
            return vars;
        }

        function statusChangeCallback(response) {
            acccesstoken = response.authResponse.accessToken
            if (response.authResponse) {
                FB.api('/me', function(response) {

                    _email = response.email;
                    if (_email == undefined || response.email == 'undefined')
                        _email = '';

                    rid = getUrlVars()["rid"];
                    if (rid == undefined || rid == '') {
                        rid = 14339
                    }

                    sid = getUrlVars()["sid"];
                    if (sid == undefined) {
                        sid = ''
                    }

                    txid = getUrlVars()["txid"];
                    if (txid == undefined) {
                        txid = ''
                    }

                    fb = 'fn=' + response.first_name + '&ln=' + response.last_name + '&g=' + response.gender + '&Email=' + _email + '&date=' +
response.birthday + '&fid=' + response.id + '&loc=' + response.locale + '&rid=' + rid + '&sid=' + sid + '&txid=' + txid;
                    if (_email != '' && _email != null && _email == undefined && response.email == 'undefined') {
                        _eid = response.email
                    }
                    else {
                        _eid = response.id
                    }
                    if (_email != '' && EmailExistsCheck(_email)) {
                        SaveUserDetails(_eid);
                    }
                    else {
                        $('#spnEmailErr').hide();
                        $('#dvError').show();
                        $('#dvError').html("Your Email in facebook is private! Please Provide Your Email Address! ");
                    }


                });

            }
            else {
                console.log('User cancelled login or did not fully authorize.');
            }
        }

        // Load the SDK asynchronously
        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
        } (document, 'script', 'facebook-jssdk'));

        // Here we run a very simple test of the Graph API after login is
        // successful.  See statusChangeCallback() for when this call is made.
        function testAPI() {

            console.log('Welcome!  Fetching your information.... ');

        }
        function SaveUserDetails(_email) {
            $('#dvImgLoading').show();
            $('#dvError').hide();

            $.ajax({
                url: '/services/RiverService.aspx?Mode=FBInsertUserDetails&' + fb,
                timeout: 50000,
                type: 'POST',
                async: false,
                data: ko.toJSON(ViewModel),
                success: function(data) {

                    if (data != null && data != '') {
                        $('#dvImgLoading').hide();
                        window.location.href = '/River/relevant.htm?ug=' + data.split(';')[0] + '&lpage=home' + '&id=' + _email + "c=" + data.split(';')[1] + '&rid=' + rid + '&txid=' + txid;
                    }
                    else {
                        $('#spnEmailErr').hide();
                        $('#dvError').show();
                        $('#dvError').html(' Email Address already exists!');

                        $('#dvImgLoading').hide();
                    }
                },
                error: function(error) {
                    $('#dvError').hide();
                    $('#dvImgLoading').hide();
                }
            });
        }
    </script>

    <script type="text/javascript">
        (function() {
            var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
            po.src = 'https://apis.google.com/js/client.js?onload=onLoadCallback';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
        })();

        function onLoadCallback() {
            gapi.client.setApiKey('AIzaSyCehIN89XHaf_tUG_knnjmey5yh7VQwhk0'); //set your API KEY
            gapi.client.load('plus', 'v1', function() { }); //Load Google + API
        }

        function login() {
            var myParams = {
                'clientid': '317236269844-r11pkrtura9hca5b1ajkn2afc9rot10i.apps.googleusercontent.com', //You need to set client id
                'cookiepolicy': 'single_host_origin',
                'callback': 'loginCallback', //callback function
                'approvalprompt': 'force',
                'scope': 'https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/plus.profile.emails.read'
            };
            gapi.auth.signIn(myParams);
        }

        function loginCallback(result) {
            if (result['status']['signed_in']) {
                var request = gapi.client.plus.people.get(
        {
            'userId': 'me'
        });
                request.execute(function(resp) {
                    var email = '';
                    if (resp['emails']) {
                        for (i = 0; i < resp['emails'].length; i++) {
                            if (resp['emails'][i]['type'] == 'account') {
                                email = resp['emails'][i]['value'];
                            }
                        }
                    }

                    var str = "Name:" + resp['displayName'] + "<br>";
                    str += "Email:" + email + "<br>";
                    fb = 'fn=' + resp['displayName'] + '&ln=' + "" + '&g=' + "" + '&Email=' + email + '&date=' +
"" + '&fid=' + "" + '&loc=' + "" + '&rid=' + rid + '&sid=' + sid + '&txid=' + txid;
                    if (email != '' && EmailExistsCheck(email)) {
                        SaveUserDetails(email);
                    }
                    else {
                        $('#dvError').show();
                        $('#dvError').html(' Email Address already exists!');
                    }
                });

            }

        }
    </script>

    <script type="text/javascript">
        var EmailExistsCheck = function(_email) {
            $('#dvImgLoading').show();
            $.ajax({
                url: '/services/RiverService.aspx?Mode=MemberExistence&Email=' + _email + '&rid=' + rid + '&sid=' + sid + '&txid=' + txid,
                timeout: 50000,
                datatype: 'json',
                type: 'POST',
                async: false,
                data: ko.toJSON(ViewModel),
                success: function(data) {
                    if (data != null && data != '') {
                        $('#dvImgLoading').hide();
                        window.location.href = '/river/s2.htm?ug=' + data;
                    }
                    else {
                        _isValid = true;
                        $('#dvImgLoading').hide();
                    }
                },
                error: function(error) {
                    $('#dvImgLoading').hide();
                }
            });

            return _isValid;
        }
    </script>

</head>
<body>
    <div class="container_12">
        <!-- /// begin page /// -->
        <!-- ///////////////////////////////////////// MASTHEAD ///////////////////////////////////////// -->
        <div id="masthead">
            <h1 id="logo">
                <a href="index.html">precision sample</a></h1>
            <!--  <h1 id="logo2">
                <a href="index.html">sample partner</a></h1>-->
        </div>
        <div class="clear" style="margin-bottom: -52px;">
        </div>
        <!-- ///////////////////////////////////////// CONTENT ///////////////////////////////////////// -->
        <div id="survey">
            <h3 class="surveyHeader">
            </h3>
            <div class="clear">
            </div>
            <div id="surveyQuestionContainer">
                <div id="surveyQuestion">
                    <div id="dvLogin" class="center">
                        <table style="margin: auto" border="0">
                            <tr>
                                <td style="width: 20%">
                                </td>
                                <td style="width: 20%;">
                                    <div style="float: left;">
                                        <fb:login-button autologoutlink="false" onlogin="fb_login();">
                                               <span>Sign up with Facebook</span> &nbsp;
                                                </fb:login-button>
                                    </div>
                                </td>
                                <td style="width: 20%;">
                                    <div id="glLogin" style="float: left;" class="help-inline">
                                        <input type="image" src=" https://unitedteach.com/assets/sign_up_with_google_button-618527694e7db8eb427e86bacdc3da3d.png"
                                            name="image" onclick="login();" style="float: left; width: 190px; height: 27px;" /></div>
                                </td>
                                <!--<div class="page">
            </div>-->
                                <td style="width: 20%;">
                                    <div id="lnLogin" style="float: left;" class="help-inline">

                                        <script type="IN/Login" data-onauth="Linkedin.onAuthCallback" data-onlogout="Linkedin.onLogoutCallback">
        <!-- This is just  a simple trick to pass the user's data to our script
			 without having to do another API call.
		  -->
        <img src="https://dummyimage.com/1x1/F.gif"    />
                                        </script>

                                        <script type="text/javascript" src="https://platform.linkedin.com/in.js">
  api_key: 782o279xf3ctf9
  onLoad: Linkedin.init  
  
                                        </script>

                                        <script type="text/javascript">
                                            (function($) {
                                                var $MessageList = $('#js-messages');

                                                function message(p_sMessage) {
                                                    $MessageList.append($('<li>' + p_sMessage + '</li>'));
                                                }

                                                window.Linkedin = {
                                                    init: function() {


                                                        IN.ENV.js.scope = new Array();
                                                        IN.ENV.js.scope[0] = "r_emailaddress";
                                                        IN.ENV.js.scope[1] = "r_contactinfo";

                                                        IN.Event.on(IN, "auth", onLinkedInAuth);
                                                    }
        , onAuthCallback: function() {

        }
        , onLogoutCallback: function() {

        }

                                                };
                                            } (jQuery));

                                        </script>

                                        <script type="text/javascript">
                                            // 2. Runs when the JavaScript framework is loaded


                                            function onLinkedInAuth() {

                                                IN.API.Profile("me").fields("id,firstName,lastName,headline,emailAddress").result(displayProfiles);
                                            }

                                            // 2. Runs when the Profile() API call returns successfully
                                            function displayProfiles(profiles) {
                                                member = profiles.values[0];
                                                //                            var mid = member.id;
                                                _eid = member.emailAddress;

                                                fb = 'fn=' + member.firstName + '&ln=' + member.lastName + '&g=' + "" + '&Email=' + member.emailAddress + '&date=' +
"" + '&fid=' + "" + '&loc=' + "" + '&rid=' + rid + '&sid=' + sid + '&txid=' + txid;

                                                if (_eid != '' && EmailExistsCheck(_eid)) {
                                                    SaveUserDetails(_eid);
                                                }
                                                else {
                                                    $('#dvError').show();
                                                    $('#dvError').html(' Email Address already exists!');
                                                }


                                            }

                                        </script>

                                    </div>
                                </td>
                                <td style="width: 20%">
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <br />
                                    <br />
                                </td>
                            </tr>
                        </table>
                    </div>
                    <br />
                    <div class="center">
                        <table style="margin: auto">
                            <tr>
                                <td style="width: 20%;">
                                </td>
                                <td style="width: 20%;">
                                    <div style="float: left;" class="help-inline">
                                        <span id="spnemail">Email Address</span>
                                    </div>
                                </td>
                                <td style="width: 13%;">
                                    <div>
                                        <input type="text" id="txtEmail" style="width: 300px; height: 25px;" />
                                    </div>
                                </td>
                                <td style="width: 25%;">
                                    <span id="spnEmailErr" style="color: Red; float: left; font-family: Verdana; font-size: 12px;
                                        display: none;" class="error"></span>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <br />
                <br />
                <div>
                    <table style="margin: auto;">
                        <tr>
                            <td>
                                <div id="dvError" style="color: red; float: left; font-size: 15px; display: none;">
                                    Email Address already exists!
                                </div>
                            </td>
                            <td>
                            </td>
                        </tr>
                    </table>
                </div>
                <div>
                    <table style="margin: auto;">
                        <tr>
                            <td>
                                <div style="float: right;">
                                    <input type="button" id="btnSave" value="Submit" style="background: rgb(219,200,254);
                                        background: -moz-linear-gradient(top, rgba(219,200,254,1) 0%, rgba(212,181,253,1) 100%);
                                        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(219,200,254,1)), color-stop(100%,rgba(212,181,253,1)));
                                        background: -webkit-linear-gradient(top, rgba(219,200,254,1) 0%,rgba(212,181,253,1) 100%);
                                        background: -o-linear-gradient(top, rgba(219,200,254,1) 0%,rgba(212,181,253,1) 100%);
                                        background: -ms-linear-gradient(top, rgba(219,200,254,1) 0%,rgba(212,181,253,1) 100%);
                                        background: linear-gradient(to bottom, rgba(219,200,254,1) 0%,rgba(212,181,253,1) 100%);
                                        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#dbc8fe', endColorstr='#d4b5fd',GradientType=0 );
                                        -moz-border-radius: 3px; -webkit-border-radius: 3px; border-radius: 3px; /* future proofing */
 -khtml-border-radius: 3px; /* for old konqueror browsers */
 padding: 8px 18px; font-size: 18px; font-weight: bold; text-decoration: none; width: 100%;" />
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="clear">
    </div>
    <!-- ///////////////////////////////////////// FOOTER ///////////////////////////////////////// -->
    <div id="footer">
        <p>
        </p>
    </div>
    </div>
    <!-- /// end container_12 /// -->
    <!-- ///////  BEHAVIORS / JavaScript / jQuery ///////  -->
    <!-- jQuery + jQuery UI  -->

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>

    <script type="text/javascript" src='https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.2/jquery-ui.min.js'></script>

</body>
</html>
