
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link href="~/Content/main/mrResponsive.css" rel="stylesheet" />
<div>


    @using (Html.BeginForm())
    {
        @Html.AntiForgeryToken()

    }
    <div ng-if="pgLoad">
        <script type="text/ng-template" id="RetailGiftCard">
            <div ng-repeat="retCard in  lstRetailGiftCard">
                <div class="reward_image_box">
                    <img ng-src="{{retCard.ImageURL}}"></img></br>
                    <span class="font">{{$index + 1 }}.{{retCard.Description}}  </span></br></br>
                    <span ng-repeat="rew in retCard.Reward" ng-init="parent = retCard" ng-include="'Reawards'" class="font" style="margin-top: 10px;"></span>
                </div>
            </div>
        </script>
        <script type="text/ng-template" id="RestaurantGiftCard">
            <div ng-repeat="restCard in  lstRestaurantGiftCard">
                <div class="reward_image_box">
                    <img ng-src="{{restCard.ImageURL}}"></img></br>
                    <span class="font">{{$index + 1 }}.{{restCard.Description}}  </span></br></br>
                    <span ng-repeat="rew in restCard.Reward" ng-init="parent = restCard" ng-include="'Reawards'" class="font" style="margin-top: 10px;"></span>
                </div>
            </div>
        </script>
        <script type="text/ng-template" id="OnlineServices">
            <div ng-repeat="onlser in  lstOnlineServices">
                <div class="reward_image_box">
                    <img ng-src="{{onlser.ImageURL}}"></img></br>
                    <span class="font">{{$index + 1 }}.{{onlser.Description}}  </span></br></br>
                    <span ng-repeat="rew in onlser.Reward" ng-init="parent = onlser" ng-include="'Reawards'" class="font" style="margin-top: 10px;"></span>
                </div>
            </div>
        </script>
        <script type="text/ng-template" id="CharitableDonation">
            <div ng-repeat="charDona in  lstCharitableDonation">
                <div class="reward_image_box">
                    <img ng-src="{{charDona.ImageURL}}"></img></br>
                    <span class="font">{{$index + 1 }}.{{charDona.Description}}  </span></br></br>
                    <span ng-repeat="rew in charDona.Reward" ng-init="parent = charDona" ng-include="'Reawards'" class="font" style="margin-top: 10px;"></span>
                </div>
            </div>
        </script>
        <script type="text/ng-template" id="Reawards">
            <span ng-if="rew.IsVariable == 'FIXED_VALUE'">
                <span ng-if="!rew.IsDisable">
                    <span ng-if="orgDetails.ClientId == 111 || orgDetails.ClientId == 73 || orgDetails.ClientId == 385">
                        <a href="#place" class="link reward_denom" ng-attr-id="{{rew.Sku+';'+(rew.Denomination)+';1'}}" ng-click="true &&  RewardClick(parent,rew,$event); $event.stopPropagation();"><span style="color: #7CADC2;">{{(rew.Denomination * 100) +'pts/$' + (rew.Denomination * 1)}}</span></a>
                    </span>

                    <span ng-if="orgDetails.ClientId != 111 && orgDetails.ClientId != 73 || orgDetails.ClientId != 385">
                        <a href="#place" class="link reward_denom" ng-attr-id="{{rew.Sku+';'+(rew.Denomination)+';1'}}" ng-click="true &&  RewardClick(parent,rew,$event); $event.stopPropagation();"><span style="color: #7CADC2;">${{rew.Denomination}}</span></a>
                    </span>

                </span>
                <span ng-if="rew.IsDisable">
                    <span ng-if="orgDetails.ClientId == 111 || orgDetails.ClientId== 73 || orgDetails.ClientId == 385">
                        <a href="#place" class="link reward_denom" ng-attr-id="{{rew.Sku+';'+(rew.Denomination)+';1'}}" ng-click="false && RewardClick(parent,rew,$event); $event.stopPropagation();" style="background: #cacaca;" title="This reward is not applicable"><span style="color: #7CADC2;">{{(rew.Denomination * 100) +'pts/$' + (rew.Denomination * 1)}}</span></a>
                    </span>

                    <span ng-if="orgDetails.ClientId != 111 && orgDetails.ClientId != 73 || orgDetails.ClientId != 385">
                        <a href="#place" class="link reward_denom" ng-attr-id="{{rew.Sku+';'+(rew.Denomination)+';1'}}" ng-click="false && RewardClick(parent,rew,$event); $event.stopPropagation();" style="background: #cacaca;" title="This reward is not applicable"><span style="color: #7CADC2;">${{rew.Denomination}}</span></a>
                    </span>
                </span>
            </span>
            <span ng-if="rew.IsVariable == 'VARIABLE_VALUE'">
                <span ng-repeat="lstRng in rew.LstRange" ng-init="parent = rew" ng-include="'RewardForRange'" class="font" style="margin-top: 10px;"></span>
            </span>

        </script>

        <script type="text/ng-template" id="RewardForRange">
            <span ng-if="!lstRng.IsDisable">
                <span ng-if="orgDetails.ClientId == 111 || orgDetails.ClientId== 73">
                    <a href="#place" class="link reward_denom" ng-attr-id="{{rew.Sku+';'+(lstRng.RewardValue)+';-1'}}" ng-click="true && RewardClick(parent,lstRng,$event); $event.stopPropagation();"><span style="color: #7CADC2;">{{lstRng.RewardValue * 100 +'pts/$'+ (lstRng.RewardValue * 1)}}</span></a>
                </span>
                <span ng-if="orgDetails.ClientId != 111 && orgDetails.ClientId != 73 || orgDetails.ClientId != 385">
                    <a href="#place" class="link reward_denom" ng-attr-id="{{rew.Sku+';'+(lstRng.RewardValue)+';-1'}}" ng-click="true && RewardClick(parent,lstRng,$event); $event.stopPropagation();"><span style="color: #7CADC2;">${{lstRng.RewardValue}}</span></a>
                </span>
                <span ng-if="orgDetails.ClientId == 385">
                    <a href="#place" class="link reward_denom" ng-attr-id="{{rew.Sku+';'+(lstRng.RewardValue)+';-1'}}" ng-click="true && RewardClick(parent,lstRng,$event); $event.stopPropagation();"><span style="color: #7CADC2;">{{lstRng.RewardValue * 1000 +'pts/$'+ (lstRng.RewardValue * 1)}}</span></a>
                </span>

            </span>
            <span ng-if="lstRng.IsDisable">
                <span ng-if="orgDetails.ClientId == 111 || orgDetails.ClientId== 73">
                    <a href="#place" class="link reward_denom" ng-attr-id="{{rew.Sku+';'+(lstRng.RewardValue)+';-1'}}" ng-click="false && RewardClick(parent,lstRng,$event); $event.stopPropagation();" style="background: #cacaca;" title="This reward is not applicable"><span style="color: #7CADC2;">{{lstRng.RewardValue * 100 +'pts/$'+ (lstRng.RewardValue * 1)}}</span></a>
                </span>
                <span ng-if="orgDetails.ClientId != 111 && orgDetails.ClientId != 73 || orgDetails.ClientId != 385">
                    <a href="#place" class="link reward_denom" ng-attr-id="{{rew.Sku+';'+(lstRng.RewardValue)+';-1'}}" ng-click="false && RewardClick(parent,lstRng,$event); $event.stopPropagation();" style="background: #cacaca;" title="This reward is not applicable">
                        <span style="color: #7CADC2;">${{lstRng.RewardValue}}</span>
                    </a>
                </span>
                <span ng-if="orgDetails.ClientId == 385">
                    <a href="#place" class="link reward_denom" ng-attr-id="{{rew.Sku+';'+(lstRng.RewardValue)+';-1'}}" ng-click="false && RewardClick(parent,lstRng,$event); $event.stopPropagation();" style="background: #cacaca;" title="This reward is not applicable"><span style="color: #7CADC2;">{{lstRng.RewardValue * 1000 +'pts/$'+ (lstRng.RewardValue * 1)}}</span></a>
                </span>

            </span>

        </script>
        <style>
            .accordion {
                margin: 10px auto;
                box-shadow: 0px 0px 0px 1px rgba(155,155,155,0.3), 0px 2px 2px rgba(0,0,0,0.1);
            }

                .accordion label {
                    padding: 2px 9px;
                    position: relative;
                    display: block;
                    cursor: pointer;
                    color: #777;
                    line-height: 25px;
                    background: #EFEFEF;
                    border: 1px solid #CCC;
                    text-align: left;
                }

                .accordion .article {
                    background: rgb(255, 255, 255);
                    overflow: hidden;
                    height: 0px;
                    -webkit-transition: all 0.3s ease-in-out;
                    -moz-transition: all 0.3s ease-in-out;
                    -o-transition: all 0.3s ease-in-out;
                    -ms-transition: all 0.3s ease-in-out;
                    transition: all 0.3s ease-in-out;
                }


                    .accordion .article p {
                        font-style: italic;
                        color: #777;
                        line-height: 23px;
                        font-size: 14px;
                        padding: 20px;
                    }


                .accordion input:checked ~ .article.ac-small {
                    height: auto;
                }

            .accontent {
                height: auto !important;
            }

            .accordion-content-ide {
                height: 0;
            }

            .reward_image_box {
                float: left;
                width: 155px;
                height: 200px;
                text-align: center;
                color: black;
                margin: 1px;
                padding: 5px;
                font-weight: bold;
                background-color: #e6e6e6;
                border: 1px solid #e0ddd4;
                overflow: auto;
            }

            .reward_denom {
                text-decoration: none;
                font-size: small;
                font-weight: initial;
                float: left;
                padding: 2px;
                border: 1px solid #54626d;
                margin: 3px;
            }
        </style>
        <div class="row">
            <div class="div-header-rewards">
                <div><b>{{'reward'|translate}}</b></div>
            </div>
            <hr class="hr-style" />
            <div class="left-aside">
                <div id="dvImageLoading">
                </div>
                <div ng-controller="rewardController">
                    <div>
                        <div class="p-l-0">
                            <div border="0" class="css-720">
                                <div class="e-r-b-720" ng-if="showRewards">
                                    <b class="f-w">
                                        <span>
                                            {{'totalEarnings'|translate}}:
                                            <span ng-if="userRewardsInfo.TotalEarnings == undefined" class="rew-userinfo">{{orgDetails.RewardTextType}}0.00</span>
                                            <span ng-if="userRewardsInfo.TotalEarnings != undefined" class="rew-userinfo"> {{orgDetails.RewardTextType}}{{userRewardsInfo.TotalEarnings |number:2}}</span>
                                        </span>
                                    </b><b class="f-w">
                                        <span>
                                            {{'totalRedeemptions'|translate}}:
                                            <span ng-if="userRewardsInfo.TotalRedemptions == undefined" class="rew-userinfo">{{orgDetails.RewardTextType}}0.00</span>
                                            <span ng-if="userRewardsInfo.TotalRedemptions != undefined" class="rew-userinfo"> {{orgDetails.RewardTextType}}{{userRewardsInfo.TotalRedemptions |number:2}}</span>
                                        </span>
                                    </b><b class="f-w">
                                        <span>
                                            {{'accountbalance'|translate}}:
                                            <span ng-if="userRewardsInfo.AccountBalance == undefined" class="rew-userinfo">{{orgDetails.RewardTextType}}0.00</span>
                                            <span ng-if="userRewardsInfo.AccountBalance != undefined" class="rew-userinfo">{{orgDetails.RewardTextType}}{{userRewardsInfo.AccountBalance |number:2}}</span>
                                        </span>
                                    </b>
                                    <br />
                                    <br />
                                </div>
                                <div class="e-r-b-720" ng-if="!showRewards">
                                    <b class="f-w">
                                        <span>
                                            {{'totalEarnings'|translate}}:
                                            <span ng-if="userRewardsInfo.TotalEarnings == undefined" class="rew-userinfo">0.00{{orgDetails.RewardTextType}}</span>
                                            <span ng-if="userRewardsInfo.TotalEarnings != undefined" class="rew-userinfo"> {{userRewardsInfo.TotalEarnings}}{{orgDetails.RewardTextType}}</span>
                                        </span>
                                    </b><b class="f-w">
                                        <span>
                                            {{'totalRedeemptions'|translate}}:
                                            <span ng-if="userRewardsInfo.TotalRedemptions == undefined" class="rew-userinfo">0.00{{orgDetails.RewardTextType}}</span>
                                            <span ng-if="userRewardsInfo.TotalRedemptions != undefined" class="rew-userinfo">{{userRewardsInfo.TotalRedemptions}}{{orgDetails.RewardTextType}}</span>
                                        </span>
                                    </b><b class="f-w">
                                        <span>
                                            {{'accountbalance'|translate}}:
                                            <span ng-if="userRewardsInfo.AccountBalance == undefined" class="rew-userinfo">0.00{{orgDetails.RewardTextType}}</span>
                                            <span ng-if="userRewardsInfo.AccountBalance != undefined" class="rew-userinfo">{{userRewardsInfo.AccountBalance}}{{orgDetails.RewardTextType}}</span>
                                        </span>
                                    </b>
                                    <br />
                                    <br />
                                </div>
                                <div>
                                    <br />
                                    <b style="float:left;font-size: medium">{{'availableRewards'|translate}} </b>
                                    <br />
                                </div>
                                <div class="rew-dv-border">
                                </div>
                                <div style="padding-top: 10px;">
                                </div>
                                <div class="container" style="width: 100%">
                                    <div class="accordion">
                                        <div ng-repeat="c in availableCards">
                                            <label for="ac-1" ng-click="tabClick($index)">{{c.cardName}}</label>
                                            <div class="article" ng-class="{accontent: tabIndex === $index }">
                                                <ng-include src="c.templateName"></ng-include>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <p class="p-r rew-disc">
                                <span>{{'disclaimer'|translate}}: </span>{{'themerchantsrepresentedare'|translate}}
                                <br />

                            </p>
                        </div>
                        <div class="pull-right">
                            <button class="btn btn-default" ng-disabled="userForm.$invalid" ng-click="historyclick(1)">{{'rewardsHistory'|translate}}</button>
                            <button class="btn btn-default" ng-disabled="userForm.$invalid" ng-click="historyclick(2)">{{'redeemedHistory'|translate}}</button>
                        </div>
                    </div>

                    <div class="rew-gird-dv center-text border-3" ng-if="reward" style="width:100%">
                        <b class="f-w rew-heading">{{'rewardsHistory'|translate}}</b>
                        <br />
                        <br />

                        <table class="table">

                            <tr ng-show="!rewHistoryLst.length">
                                <td>
                                    {{'noRewardsHistory' | translate}}
                                </td>
                            </tr>

                            <thead ng-show="rewHistoryLst.length > 0">
                                <tr class="rew-tr">
                                    <th>{{'date'|translate}}</th>
                                    <th>{{'description'|translate}}</th>
                                    <th>{{'direct'|translate}}</th>
                                    @*<th>Level 1</th>
                                        <th>Level 2</th>*@
                                    <th>{{'redeemed'|translate}}</th>
                                    <th>{{'balance'|translate}}</th>
                                    @*<th>Expiry Date</th>*@
                                    <th>{{'surveyStatus'|translate}}</th>
                                </tr>
                                <tr ng-class-even="'tr-bg'" ng-repeat="rh in rewHistoryLst" ng-class="{even:$even,odd:$odd}">
                                    <td align="left" scope="col"><span>{{rh.CreateDt}}</span></td>
                                    <td align="left" scope="col" style="width:180px;"><span>{{rh.Descripion}}</span></td>
                                    <td align="left" scope="col"><span>{{rh.RewardAmount}}</span></td>
                                    @*<td align="left" scope="col">{{rh.Level1Reward}}</td>
                                        <td align="left" scope="col">{{rh.Level2Reward}}</td>*@
                                    <td align="left" scope="col"><span>{{rh.RedemptionAmount}}</span></td>
                                    <td align="left" scope="col"><span>{{rh.BalanceAmount}}</span></td>
                                    @*<td align="left" scope="col">{{rh.RewardExpiryDt}}</td>*@
                                    <td align="left" scope="col">{{rh.Status}}</td>
                                </tr>
                            </thead>

                        </table>
                        <section layout="row">
                            <pagging-directive></pagging-directive>
                        </section>
                    </div>
                </div>
                <div ng-controller="redeemController">
                    <div class="redeem-gird-dv center-text border-3" ng-if="redeemHistLstgrid">
                        <b class="f-w rew-heading">{{'rewardsRedeemedHistory'|translate}}</b>
                        <br />
                        <br />

                        <table class="table">
                            <tr ng-show="!redeemHistLst.length">
                                <td>
                                    {{'noRedeemHistory'|translate}}
                                </td>
                            </tr>
                            <thead ng-show="redeemHistLst.length > 0">
                                <tr class="rew-tr">
                                    <th> {{'redeemedDate'|translate}}</th>
                                    <th> {{'amountRedeemed'|translate}}</th>
                                    <th> {{'redemptionType'|translate}}</th>
                                    <th> {{'codeRedeemed'|translate}} </th>
                                </tr>
                                <tr ng-class-even="'tr-bg'" ng-repeat="rhd in redeemHistLst" ng-class="{even:$even,odd:$odd}">
                                    <td align="left" scope="col"><span>{{rhd.CreateDt}}</span></td>
                                    <td align="left" scope="col"><span>{{rhd.RedemptionAmount}}</span></td>
                                    <td align="left" scope="col"><span>{{rhd.RedemptionType}}</span></td>
                                    <td align="left" scope="col"><span>{{rhd.Descripion}}</span></td>
                                </tr>
                            </thead>

                        </table>
                        <section layout="row" layout-padding="">
                            <pagging-directive></pagging-directive>
                        </section>
                    </div>
                </div>
            </div>
        </div>

    </div>

</div>
